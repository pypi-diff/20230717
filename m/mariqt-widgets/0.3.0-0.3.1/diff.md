# Comparing `tmp/mariqt_widgets-0.3.0-py2.py3-none-any.whl.zip` & `tmp/mariqt_widgets-0.3.1-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,17 +1,17 @@
-Zip file size: 45512 bytes, number of entries: 15
--rw-r--r--  2.0 unx      128 b- defN 23-Jun-23 14:24 mariqt_widgets/__init__.py
--rw-r--r--  2.0 unx   106778 b- defN 23-Jun-23 14:24 mariqt_widgets/ifdo_create.py
--rw-r--r--  2.0 unx     6080 b- defN 23-Jun-23 14:24 mariqt_widgets/ifdo_excel.py
--rw-r--r--  2.0 unx    52516 b- defN 23-Jun-23 14:24 mariqt_widgets/notebook_widgets.py
--rw-rw-rw-  2.0 unx     1520 b- defN 23-Jun-23 14:24 mariqt_widgets/icons/checkbox-circle-line_gray.png
--rw-rw-rw-  2.0 unx     1525 b- defN 23-Jun-23 14:24 mariqt_widgets/icons/checkbox-circle-line_green.png
--rw-rw-rw-  2.0 unx     1502 b- defN 23-Jun-23 14:24 mariqt_widgets/icons/error-warning-line_gray.png
--rw-rw-rw-  2.0 unx     1513 b- defN 23-Jun-23 14:24 mariqt_widgets/icons/error-warning-line_orange.png
--rw-rw-rw-  2.0 unx     1470 b- defN 23-Jun-23 14:24 mariqt_widgets/icons/error-warning-line_red.png
--rw-rw-rw-  2.0 unx      118 b- defN 23-Jun-23 14:25 mariqt_widgets-0.3.0.dist-info/AUTHORS.md
--rw-rw-rw-  2.0 unx     1506 b- defN 23-Jun-23 14:25 mariqt_widgets-0.3.0.dist-info/LICENSE
--rw-r--r--  2.0 unx     1443 b- defN 23-Jun-23 14:25 mariqt_widgets-0.3.0.dist-info/METADATA
--rw-r--r--  2.0 unx      110 b- defN 23-Jun-23 14:25 mariqt_widgets-0.3.0.dist-info/WHEEL
--rw-r--r--  2.0 unx       15 b- defN 23-Jun-23 14:25 mariqt_widgets-0.3.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     1397 b- defN 23-Jun-23 14:25 mariqt_widgets-0.3.0.dist-info/RECORD
-15 files, 177621 bytes uncompressed, 43154 bytes compressed:  75.7%
+Zip file size: 45923 bytes, number of entries: 15
+-rw-r--r--  2.0 unx      128 b- defN 23-Jul-17 08:36 mariqt_widgets/__init__.py
+-rw-r--r--  2.0 unx   106778 b- defN 23-Jul-17 08:36 mariqt_widgets/ifdo_create.py
+-rw-r--r--  2.0 unx     7851 b- defN 23-Jul-17 08:36 mariqt_widgets/ifdo_excel.py
+-rw-r--r--  2.0 unx    52498 b- defN 23-Jul-17 08:36 mariqt_widgets/notebook_widgets.py
+-rw-rw-rw-  2.0 unx     1520 b- defN 23-Jun-20 13:58 mariqt_widgets/icons/checkbox-circle-line_gray.png
+-rw-rw-rw-  2.0 unx     1525 b- defN 23-Jun-20 13:58 mariqt_widgets/icons/checkbox-circle-line_green.png
+-rw-rw-rw-  2.0 unx     1502 b- defN 23-Jun-20 13:58 mariqt_widgets/icons/error-warning-line_gray.png
+-rw-rw-rw-  2.0 unx     1513 b- defN 23-Jun-20 13:58 mariqt_widgets/icons/error-warning-line_orange.png
+-rw-rw-rw-  2.0 unx     1470 b- defN 23-Jun-20 13:58 mariqt_widgets/icons/error-warning-line_red.png
+-rw-rw-rw-  2.0 unx      118 b- defN 23-Jul-17 08:36 mariqt_widgets-0.3.1.dist-info/AUTHORS.md
+-rw-rw-rw-  2.0 unx     1506 b- defN 23-Jul-17 08:36 mariqt_widgets-0.3.1.dist-info/LICENSE
+-rw-r--r--  2.0 unx     1443 b- defN 23-Jul-17 08:36 mariqt_widgets-0.3.1.dist-info/METADATA
+-rw-r--r--  2.0 unx      110 b- defN 23-Jul-17 08:36 mariqt_widgets-0.3.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx       15 b- defN 23-Jul-17 08:36 mariqt_widgets-0.3.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     1397 b- defN 23-Jul-17 08:36 mariqt_widgets-0.3.1.dist-info/RECORD
+15 files, 179374 bytes uncompressed, 43565 bytes compressed:  75.7%
```

## zipnote {}

```diff
@@ -21,26 +21,26 @@
 
 Filename: mariqt_widgets/icons/error-warning-line_orange.png
 Comment: 
 
 Filename: mariqt_widgets/icons/error-warning-line_red.png
 Comment: 
 
-Filename: mariqt_widgets-0.3.0.dist-info/AUTHORS.md
+Filename: mariqt_widgets-0.3.1.dist-info/AUTHORS.md
 Comment: 
 
-Filename: mariqt_widgets-0.3.0.dist-info/LICENSE
+Filename: mariqt_widgets-0.3.1.dist-info/LICENSE
 Comment: 
 
-Filename: mariqt_widgets-0.3.0.dist-info/METADATA
+Filename: mariqt_widgets-0.3.1.dist-info/METADATA
 Comment: 
 
-Filename: mariqt_widgets-0.3.0.dist-info/WHEEL
+Filename: mariqt_widgets-0.3.1.dist-info/WHEEL
 Comment: 
 
-Filename: mariqt_widgets-0.3.0.dist-info/top_level.txt
+Filename: mariqt_widgets-0.3.1.dist-info/top_level.txt
 Comment: 
 
-Filename: mariqt_widgets-0.3.0.dist-info/RECORD
+Filename: mariqt_widgets-0.3.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## mariqt_widgets/__init__.py

```diff
@@ -1,5 +1,5 @@
 """Top-level package for mariqt_widgets."""
 
 __author__ = """Karl Heger"""
 __email__ = 'kheger@geomar.de'
-__version__ = '0.3.0'
+__version__ = '0.3.1'
```

## mariqt_widgets/ifdo_excel.py

```diff
@@ -1,10 +1,11 @@
 import sys
 #sys.path.insert(0, '/home/karl/Documents/HMC/mariqt/') # just for testing!
 import pandas as pd
+import os
 from pprint import pprint
 
 import mariqt.sources.ifdo as miqtf
 import mariqt.files as miqtff
 import mariqt.variables as miqtv
 import mariqt.sources.ifdo as miqtiFDO
 import mariqt.core as miqtc
@@ -106,14 +107,15 @@
     input_excel_file: input Excel file (generate with *iFDO_exportToExcel.ipynb* and edit)
     ifdo_file: iFDO file to be updated
     sheet_name: name of the sheet in the input Excel file containing the respective data """
 
     print("Using mariqt version",miqtv.version)
 
     excel_data_df = pd.read_excel(input_excel_file, sheet_name, header=None,dtype = str)
+    
     # remove uncool chars
     excel_data_df = excel_data_df.replace({'‘':'\'','’':'\''},regex=True)
     excel_data_df_dict = excel_data_df.to_dict(orient='index')
 
     # find 'image-set-name' and create index -> image-set-name dict
     imageSetsIndices = {}
     setUpdates = {}
@@ -135,17 +137,62 @@
             miqtc.recursiveEval(value)
             for fieldIndex, val in value.items():
                 if fieldIndex != 0:
                     if str(val).lower() == "nan" or str(val).strip() == "":
                         val = ""
                     setUpdates[imageSetsIndices[fieldIndex]][fieldName] = val
 
+    #pprint(setUpdates)
+    
     # create iFDO object
     iFDO = miqtiFDO.iFDOFromFile(ifdo_file, ignore_image_files=True)
 
     #pprint(iFDO.ifdo_tmp)
 
     if iFDO.findTmpField('image-set-name') not in setUpdates:
-        raise Exception("Could not find image set in Excel: " + iFDO['image-set-name'])
+        raise Exception("Could not find image set in Excel: " + iFDO.findTmpField('image-set-name'))
 
     iFDO.update_ifdo_header_fields(setUpdates[iFDO.findTmpField('image-set-name')])
-    iFDO.write_ifdo_file()
+    iFDO.update_fields()
+    iFDO.write_ifdo_file()
+
+
+def excel_to_markdown(input_excel_file:str, sheet_name:str=None, output_file:str=None, overwrite=False):
+    """ Convert Excel file to markdown table """
+    if sheet_name is None:
+        df = pd.read_excel(input_excel_file)
+    else:
+        df = pd.read_excel(input_excel_file,sheet_name=sheet_name)
+    df.columns = df.columns.str.strip()
+    md_table = df.to_markdown(index=False)
+    md_table = md_table.replace('nan','')
+    
+    if output_file is None:
+        output_file = miqtff.changeFileExtension(input_excel_file,'md')
+    if not overwrite and os.path.isfile(output_file):
+        raise Exception("File exists: " + output_file)
+    with open(output_file,'w') as file:
+        file.write(md_table)
+    return output_file
+
+
+def markdown_to_excel(input_md_file:str, sheet_name:str="Sheet1", output_file:str=None, overwrite=False):
+    """ Convert markdown file to Excel file.  """
+    # Read a markdown file, getting the header from the first row and idnex from the second column
+    df = pd.read_table(input_md_file, sep="|", 
+                       header=None, 
+                       index_col=1, skipinitialspace=True)
+
+    # Drop the left-most and right-most null columns 
+    df = df.dropna(axis=1, how='all')
+
+    # Drop the header underline row
+    df = df.drop(df.index[1])
+
+    if output_file is None:
+        output_file = miqtff.changeFileExtension(input_md_file,'xlsx')
+    if not overwrite and os.path.isfile(output_file):
+        raise Exception("File exists: " + output_file)
+    with pd.ExcelWriter(output_file) as writer:
+        df.style.applymap(lambda _: 'vertical-align: top').to_excel(writer,header=False,sheet_name="Stations")
+
+    return output_file
```

## mariqt_widgets/notebook_widgets.py

```diff
@@ -128,17 +128,17 @@
         self.image.layout.width = '15px'
         self.image.layout.hight = '15px'
         self.image.layout.max_width = '15px'
         self.image.layout.max_hight = '15px'
         
         self.paint()
         
-        # def warningOnce(self):
-        #     """ sets next invalid to warning """
-        #     self.warning = True
+    def warningOnce(self):
+        """ sets next invalid to warning """
+        self.warning = True
 
     def paint(self):
         if self.valid:
             if self.disabled:
                 if self.warning:
                     self.image.value = self.icon_errorDisabled
                 else:
```

## Comparing `mariqt_widgets-0.3.0.dist-info/LICENSE` & `mariqt_widgets-0.3.1.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `mariqt_widgets-0.3.0.dist-info/METADATA` & `mariqt_widgets-0.3.1.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: mariqt-widgets
-Version: 0.3.0
+Version: 0.3.1
 Summary: Contains widgets commonly used by MarIQT Notebooks.
 Home-page: https://codebase.helmholtz.cloud/datahub/marehub/ag-videosimages/mariqt-notebook-widgets
 Author: Karl Heger
 Author-email: kheger@geomar.de
 License: GNU General Public License v3
 Keywords: mariqt_widgets
 Classifier: Development Status :: 2 - Pre-Alpha
```

## Comparing `mariqt_widgets-0.3.0.dist-info/RECORD` & `mariqt_widgets-0.3.1.dist-info/RECORD`

 * *Files 22% similar despite different names*

```diff
@@ -1,15 +1,15 @@
-mariqt_widgets/__init__.py,sha256=WqPt4BlQf0SBD5k9afDiAvIGveMxNRxtkTQW6KD3mtc,128
+mariqt_widgets/__init__.py,sha256=p3CNQ5qJI5rNvZq1B9qM4e87GEJlVwzkXiNpTSD0tUM,128
 mariqt_widgets/ifdo_create.py,sha256=wAIHtV-BUXDjkejfeByag1AnMaZjHjsVscDmc_6KytM,106778
-mariqt_widgets/ifdo_excel.py,sha256=R-0jCwoC7S7ur6pD2Vek0BEh6pdxXPWxGciwED400Wk,6080
-mariqt_widgets/notebook_widgets.py,sha256=Rpx9U2N-guLiGHebAQRLGQsQeHmJqPzuSOq_yy2amyk,52516
+mariqt_widgets/ifdo_excel.py,sha256=qVz0Tsz1djxzYajVFgis8ohrXS_ZWrtdYVCypz6aMwk,7851
+mariqt_widgets/notebook_widgets.py,sha256=074sLRRNtLSmaaHM5rKK4aCLFLFO7u6zjyQL4i-a1Wg,52498
 mariqt_widgets/icons/checkbox-circle-line_gray.png,sha256=RaFzsWg0opiHsSYaOP61cLgu36lVDLnwyNUsJwMhnww,1520
 mariqt_widgets/icons/checkbox-circle-line_green.png,sha256=jHZmxJJLY-7dMGDUxBYAkBCFySeS05DQPbAd7vmX49s,1525
 mariqt_widgets/icons/error-warning-line_gray.png,sha256=_ZjMCCHce_zdD9QekKubV66bHwicRIY1ncjy1O8wTmE,1502
 mariqt_widgets/icons/error-warning-line_orange.png,sha256=3Jt4GaLi-mHRPDz9lLHbwwvUaG2gttT-J90WquqXMNk,1513
 mariqt_widgets/icons/error-warning-line_red.png,sha256=gF0m6xbCcX1LQ0kwjIkPln6eLGOL9dSF2h4rqEjU0HU,1470
-mariqt_widgets-0.3.0.dist-info/AUTHORS.md,sha256=fHR702RktmLjB6uJ0FIzG-DTjVXU4tQ4mFh0jeBP-Ns,118
-mariqt_widgets-0.3.0.dist-info/LICENSE,sha256=OHxJeWWJWP1rrSwBbdFqDnWwhFn2dM_2L7mtXcqSh-c,1506
-mariqt_widgets-0.3.0.dist-info/METADATA,sha256=kVnNOrIoXQ6ibI3Co8IFyAJFRKA3UAJ14rUOetMCC1Q,1443
-mariqt_widgets-0.3.0.dist-info/WHEEL,sha256=a-zpFRIJzOq5QfuhBzbhiA1eHTzNCJn8OdRvhdNX0Rk,110
-mariqt_widgets-0.3.0.dist-info/top_level.txt,sha256=Ul1udsokY_DyTjF0ePRHxZjs46MX931t8CKpdL2oDTc,15
-mariqt_widgets-0.3.0.dist-info/RECORD,,
+mariqt_widgets-0.3.1.dist-info/AUTHORS.md,sha256=fHR702RktmLjB6uJ0FIzG-DTjVXU4tQ4mFh0jeBP-Ns,118
+mariqt_widgets-0.3.1.dist-info/LICENSE,sha256=OHxJeWWJWP1rrSwBbdFqDnWwhFn2dM_2L7mtXcqSh-c,1506
+mariqt_widgets-0.3.1.dist-info/METADATA,sha256=OO85_24kCol3TDBcXMQetoMgy9dabln5dbMZ5m-1O4U,1443
+mariqt_widgets-0.3.1.dist-info/WHEEL,sha256=a-zpFRIJzOq5QfuhBzbhiA1eHTzNCJn8OdRvhdNX0Rk,110
+mariqt_widgets-0.3.1.dist-info/top_level.txt,sha256=Ul1udsokY_DyTjF0ePRHxZjs46MX931t8CKpdL2oDTc,15
+mariqt_widgets-0.3.1.dist-info/RECORD,,
```

